import "./chunk-P5JGOPVX.js";
import {
  init_esm_shims
} from "./chunk-WWCIODDN.js";

// Events/Observer/giveaways.ts
init_esm_shims();
import { Events, EmbedBuilder } from "discord.js";
import { readFileSync, writeFileSync } from "fs";
var giveaways_default = {
  name: Events.ClientReady,
  async execute(client) {
    const channel = client.channels.cache.get("1178073046444163102" /* test */);
    async function check() {
      const now = Date.now();
      let giveaways = JSON.parse(readFileSync("./JSON/giveaways.json", "utf8"));
      for (const giveaway of giveaways) {
        if (now > giveaway.endTime) {
          const winner = giveaway.participants[Math.floor(Math.random() * giveaway.participants.length)];
          const message = await channel.messages.fetch(giveaway.messageId);
          const embed = EmbedBuilder.from(message.embeds[0]);
          embed.data.fields[1].name = "Gewinner";
          embed.data.fields[1].value = `<@${winner}>`;
          await message.edit({ embeds: [embed], components: [] });
          await message.reply({ content: `\u{1F389} **\xBB** Herzlichen Gl\xFCckwunsch <@${winner}>! Du hast **${giveaway.prize}** gewonnen!` });
          giveaways = giveaways.filter((g) => g.messageId != giveaway.messageId);
          writeFileSync("./JSON/giveaways.json", JSON.stringify(giveaways, null, 2), "utf8");
        }
      }
    }
    await check();
    setInterval(check, 6e4);
  }
};
export {
  giveaways_default as default
};
